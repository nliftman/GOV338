---
title: "Lab 4"
author: "Naomi Liftman"
date: "2023-04-04"
output: pdf_document
---
# Lab 4

I will be using the `civil_rights.csv` data, as the data we are using for our project is two datasets each with around 35,000 edges. 

Part 1- loading data and summary statistics

## Part 1
### Question 1
Load your data, convert it into a network, and plot it. For now, only load rio , igraph, and tidyverse.

```{r message = FALSE, warning = FALSE, error = FALSE}
library(rio)
library(igraph)
library(tidyverse)
```

```{r}
#import data
civ <- import("/Users/naomiliftman/Desktop/GOV338/lab4/civil_rights.csv")
#create a network
civ_net <- graph.data.frame(civ, directed=T)
#plot
plot(civ_net, edge.width=.3,  edge.arrow.size=.3,
     vertex.color="green")
```


### Question 2
```{r}
#providing descriptive statistics
gsize(civ_net)
vcount(civ_net)
summary(degree(civ_net))
edge_density(civ_net)
```
There are 50 nodes and 263 edges. The minimum is 3, maximum is 21, and mean is 10.52. The density of the network is .107. 


### Question 3 
```{r}
degree(civ_net)
```
The three nodes with the highest degrees in the data are MN (Minnesota) with 21, UT (Utah) with 17, and then CT (Connecticut) and CA (California) are tied for the third highest degree with 16 each. 


## Part 2
### Question 4 
```{r}
library(concoR)
#turn into a matrix
civ_mat <- as.matrix(get.adjacency(civ_net))
#correlation of ties
civ_cor <- data.frame(cor(civ_mat)) 
civ_cor <- civ_cor[-c(1:1), ]
civ_cor %>% 
  summarize(max = max(VA))
```

The node that is most strongly correlated with the first node (VA) is Virginia, as they are the same node and thus have a correlation of 1. Other than that the other node that is most strongly correlated with the first is MI (Minnesota). 

### Question 5
```{r}
blocks <- concor_hca(list(civ_mat)) 
blocks %>% 
  summarize(m = max(block))
```

Using Concor's hierarchical clustering algorithm we produced two blocks.

### Question 6

```{r}
V(civ_net)$blocks <- blocks$block

plot.igraph(civ_net, vertex.color=V(civ_net)$blocks, edge.width=.5, edge.arrow.size=.3,      vertex.label.color="black")

```


### Question 7
Look at the plot, the correlation matrix, and your calculations for node degree. Were you surprised by which groups were put in the same block?

Part 3- Dendograms and collapsed block graphs
You can now load SNA and network. Use the equiv.clust command to calculate structurally equivalent nodes in your matrix. Plot the results.

Partition your data (rect.hclust command) by the number of blocks you believe best divide the plot produced in 8. Re-make the plot with the partitions overlaid.

Estimate the blockmodel (blockmodel) with the specified number of divisions you felt was the best fit for 9. Plot the collapsed version of the block model (see gplot sample code).

Lastly, look at the nodes that are assigned to the same blocks. Can you identify any similar between these nodes, either in how they appear in the visualized network, or based on some characteristics of the nodes? For example, are states grouped by ideology/region, etc?