---
title: "data!"
author: "Naomi Liftman"
format: pdf
editor: visual
---

# Packages

```{r warning = FALSE, error = FALSE, message = FALSE}
library(incidentally)
library(backbone)
library(smnet)
library(igraph)
library(tidyverse)
library(rio)
library(tidyr)
```

# Scott Code for Cosponsorship of 117th

```{r warning = FALSE, message = FALSE, error = FALSE}
#pull the 117 congress connections 
B_117 <- incidence.from.congress(session = 117, types = c("sres"), areas = c("All"), format = "igraph")

network_117 <- sdsm(B_117, alpha = 0.01, narrative = TRUE)

## Creates matrix object (note adjacency matrix)
el_mat_117 <- as_edgelist(network_117)

### creates data frame object
el_117 <- as.data.frame(as_edgelist(network_117))
```

# Mutating Cosponsorship of 117th

```{r}
#remove the senator title from both columns
el_117$V1 <- sub("Sen. ", "", el_117$V1)
el_117$V2 <- sub("Sen. ", "", el_117$V2)

#remove everything after the [
el_117$V1 <- gsub("\\[.*","", el_117$V1)
el_117$V2 <- gsub("\\[.*","", el_117$V2)

#add new columns with the first and last names
el_117$v1_first <- gsub(".*\\, ", "", el_117$V1)   
el_117$v1_last <- gsub("\\,.*","", el_117$V1)
el_117$v2_first <- gsub(".*\\, ", "", el_117$V2)   
el_117$v2_last <- gsub("\\,.*","", el_117$V1) 

#adding them together!
edge_117 = el_117 %>% 
  unite(v1_full, c(v1_first, v1_last), sep = "", remove = FALSE) %>% 
  unite(v2_full, c(v2_first, v2_last), sep = "", remove = FALSE) %>% 
  select(v1_full, v2_full)
```

# Religion Data 117th

```{r}
#importing the df 
religion_117 <- import("/Users/naomiliftman/Desktop/GOV338/Final Project/117congress.xlsx") 

#rename the last five names
relig_117 <- religion_117 %>% 
  rename_with(~ tolower(gsub(".", "", .x, fixed = TRUE))) %>% 
  rename("type" = 2) %>% 
  rename("name" = 3) %>% 
  rename("party" = 4 ) %>% 
  rename("cont" = 5) %>% 
  rename("religion" = 6)

#rename the state
names(relig_117)[1] = "state"  

#remove the first row
relig_117 <- relig_117[-c(1:1), ]
```

# Scott Code for Cosponsorship of 112th

```{r warning = FALSE, message = FALSE, error = FALSE}
#pull the 117 congress connections 
B_112 <- incidence.from.congress(session = 112, types = c("sres"), areas = c("All"), format = "igraph")

network_112 <- sdsm(B_112, alpha = 0.01, narrative = TRUE)

## Creates matrix object (note adjacency matrix)
el_mat_112 <- as_edgelist(network_112)

### creates data frame object
el_112 <- as.data.frame(as_edgelist(network_112))
```

# Mutating Cosponsorship of 117th

```{r}
#remove the senator title from both columns
el_112$V1 <- sub("Sen. ", "", el_112$V1)
el_112$V2 <- sub("Sen. ", "", el_112$V2)

#remove everything after the [
el_112$V1 <- gsub("\\[.*","", el_112$V1)
el_112$V2 <- gsub("\\[.*","", el_112$V2)

#add new columns with the first and last names
el_112$v1_first <- gsub(".*\\, ", "", el_112$V1)   
el_112$v1_last <- gsub("\\,.*","", el_112$V1)
el_112$v2_first <- gsub(".*\\, ", "", el_112$V2)   
el_112$v2_last <- gsub("\\,.*","", el_112$V1) 

#adding them together!
edge_112 = el_112 %>% 
  unite(v1_full, c(v1_first, v1_last), sep = "", remove = FALSE) %>% 
  unite(v2_full, c(v2_first, v2_last), sep = "", remove = FALSE) %>% 
  select(v1_full, v2_full)
```

# Religion Data 112th

```{r}
#importing the df 
#need to get a new csv from my boy scott!
```

# Merging the 117th Religion and edge list \<3

```{r}
#okay only wanna see name and religion and the type 
#cant figure out why we dont have any house repts
relig_117 <- relig_117 %>% 
  select(name, religion, type)

#now we have something that has the first senators religion
t_117 <- full_join(relig_117, edge_117, by = c("name" = "v1_full")) 

#rename so we have a name i and a religion i 
t_117 <- t_117 %>% 
  rename("name_i" = "name",
         "religion_i" = "religion") 

#now we have something that has the second senators religion
jesus_117 <- full_join(relig_117, edge_117, by = c("name" = "v2_full"))

#rename so we have a name j and a religion j 
jesus_117 <- jesus %>% 
  rename("name_j" = "name",
         "religion_j" = "religion") %>% 
  is.na(jesus$v1_full)

all_117 <- cbind(jesus, t_117)
```
